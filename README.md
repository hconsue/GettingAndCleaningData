
# Getting and Cleaning Data Course Project #

## README DOCUMENT ##
This document sumarizes the steps for tranforming the input data source generated by the Human Activity Recognition Using Smartphones Dataset experiment into the data set requested as part of the final project for the Coursera's Getting and Cleaning Data Course.

The purpose of this project is to demonstrate the ability to collect, work with, and clean a data set. The goal is to prepare tidy data that can be used for later analysis based on the information provided by the mentioned experiment.

For more information about the experiment, the input data source and the structure of the requested data set, please read the Code Book attached.


PROCESSING THE SOURCE DATA
--------------------------
The steps to generate a summarized data set taking the source data as input are (according with the project request):

1. Merge the training and the test sets to create one data set. Add information about the 
   subject and the activity performed.
2. Extract only the measurements on the mean and standard deviation for each measurement.
3. Use descriptive activity names to name the activities in the data set.
4. Appropriately labels the data set with descriptive variable names.
5. From the data set in step 4, creates a second, independent tidy data set with the average of each 
   variable for each activity and each subject.

================
THE TIDY DATASET
================
For the generation of the requested tidy data set, the criteria learned in the course were taken into 
consideration:

1. Each variable measured should be in one column
2. Each different observation of that variable should be in a diferent row.
3. There should be one table for each "kind" of variable.
4. if there are multiple tables, they should include a column in the table that allows them to be linked.
5. Include a row at the top of each file with variable names.
6. Make variable names human readeable.

==============================
READING THE GENERATED DATA SET
==============================
The data set generated, TidyDataset.txt, should be read in R using the following instruction (assuming
that the file is in the working directory):

TidyDataset <- read.table("TidyDataset.txt", header = TRUE)

See the CodeBook.md attached file for details about the dataset structure.

===================================
THE PROGRAM TO GENERATE THE DATASET
===================================
The program requires the "dplyr" package.

----------------------------------------------------------------------------------
library(dplyr)
----------------------------------------------------------------------------------

The program reads the Train and Test files containing de measurements of the
experiment. The files do not have heading for the columns. The files are binded 
by rows with Train info above Test info. This order is important when merging 
Train and Test subjects and activities files.
----------------------------------------------------------------------------------
## Read and join by rows Train and Test Measurements
X_train_measures <- read.table("./train/X_train.txt", header = FALSE)
X_test_measures  <- read.table("./test/X_test.txt", header = FALSE)

measures <- rbind(X_train_measures, X_test_measures)
----------------------------------------------------------------------------------

The program reads Train and Test Activities that correspond to the Measurements
file in the same order. The files are binded in the same order as the measurements
files.
----------------------------------------------------------------------------------
## Read and join by rows Train and Test Activity code corresponding to each
## Measurement. 
X_train_activities <- read.table("./train/y_train.txt", header = FALSE)
X_test_activities  <- read.table("./test/y_test.txt", header = FALSE)

activities <- rbind(X_train_activities, X_test_activities)
----------------------------------------------------------------------------------

Similar actions for the Subjects information. In addition, a name is assigned to
the resulting dataframe column.
----------------------------------------------------------------------------------
## Read and join by rows Train and Test Subjects code corresponding to each
## Measurement. Assign the column name. 
X_train_subjects <- read.table("./train/subject_train.txt", header = FALSE)
X_test_subjects  <- read.table("./test/subject_test.txt", header = FALSE)

subjects <- rbind(X_train_subjects, X_test_subjects)
names(subjects) <- c("subjectid")
---------------------------------------------------------------------------------

The program reads the names of the master file for the Activities: WALKING, 
WALKING_UPSTAIRS, etc. This information is merged with the Activities of each
observation in the experiment to replace the code by the descrition of the Activity.
---------------------------------------------------------------------------------
## Read the Activities code - description table: activity_labels
activity_labels <- read.table("activity_labels.txt", header = FALSE)

## Merge activities and activity_labels to get the description of the activity 
## of each Measurement. We are interested in the second column of the merge: the
## one with the description. Assign the column name.
activities_description <- left_join(activities, activity_labels,
                                by.x = "V1", by.y = "V1", all = TRUE)[2]
names(activities_description) <- c("activity")

Now, the program reads the names of the columns/variables of the Measurement files.
The informations read is used to name each column of the measurements
--------------------------------------------------------------------------------
## Read the Features, that is the name of each column of the Measurements files.
## The second column of the information read contains the names.
features <- read.table("features.txt", header = FALSE)

## Assign the features just read as the column names for the measures data frame
names(measures) <- features[,2]
--------------------------------------------------------------------------------

The colums names with "mean" or "std" are selected for the final data set. The rest 
of the columns are ignored. This is in accordance with the specifications of the
project.
--------------------------------------------------------------------------------
## Select only the measures columns with reference to "mean" or "standard
## deviation". Discard the rest of the columns.
measures <- measures[grep("std|mean", names(measures), ignore.case = TRUE)]
--------------------------------------------------------------------------------

Now, it is time to bind the colums of the three structures created: Subjects,
Activities and Measurements.
-------------------------------------------------------------------------------- 
## Join by columns subject, activities_description, and the selected columns
## of measures (measurements).
total_dataset <- cbind(subjects, activities_description, measures)
--------------------------------------------------------------------------------

This is the core of the programa. Here the information is grouped by subject and
ativity. After this, the mean of each numeric column is calculated inside each
resulting group.
--------------------------------------------------------------------------------
## Group the resulting data set by subjectid and activity; calculates the 
## columns means. 
final_dataset <- total_dataset %>% 
                 group_by(subjectid, activity) %>%
                 summarise(across(everything(), mean))
--------------------------------------------------------------------------------

Before, writing the result to disc, some housekeeping over the names of the
columns as explained in the comments below.
--------------------------------------------------------------------------------
## Capitalize the first letter of "mean"and "std" in column names 
names(final_dataset) <- gsub("mean","Mean", names(final_dataset),
                             ignore.case = TRUE)
names(final_dataset) <- gsub("std","Std", names(final_dataset),
                             ignore.case = TRUE)

## Eliminate special characters from the column names: "-", "(", ")", and ","
names(final_dataset) <- gsub("[-]","", names(final_dataset))
names(final_dataset) <- gsub("[(]","", names(final_dataset))
names(final_dataset) <- gsub("[)]","", names(final_dataset))
names(final_dataset) <- gsub("[,]","", names(final_dataset))
-------------------------------------------------------------------------------

Finally, the program writes the data set to disk as "TidyDataset.txt" in the
working directory. To read this file, check the section READING THE GENERATED
DATA SET
-------------------------------------------------------------------------------
## Write final_dataset to disk
write.table(final_dataset, file = "TidyDataset.txt", quote = FALSE, 
            row.names = FALSE, sep = " ")
-------------------------------------------------------------------------------
